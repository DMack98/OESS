<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE busconfig PUBLIC
  "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
  "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>

  <!-- Permit the root user to invoke all of the methods on openflow abstraction layer, its jobs                                                                                                                                   
       or their instances, and to get and set properties. -->
  <policy user="root">
    <allow own="org.nddi.openflow" />
    <allow send_destination="org.nddi.openflow"
           send_interface="org.freedesktop.DBus.Properties" />
    <allow send_destination="org.nddi.openflow"
           send_interface="org.freedesktop.DBus.Introspectable" />
    <allow send_destination="org.nddi.openflow"
           send_interface="org.nddi.openflow" />
  </policy>

  <policy user="_oess">
        <allow own="org.nddi.openflow" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.freedesktop.DBus.Properties" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.freedesktop.DBus.Introspectable" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.nddi.openflow" />
   </policy>


  <policy user="_snapp">
        <allow own="org.nddi.openflow" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.freedesktop.DBus.Properties" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.freedesktop.DBus.Introspectable" />
        <allow send_destination="org.nddi.openflow"
               send_interface="org.nddi.openflow" />
   </policy>

  <!-- readonly api -->

  <policy user="root">
    <allow own="org.nddi.openflow_readonly" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Properties" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Introspectable" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.nddi.openflow_readonly" />
  </policy>

  <policy user="_oess">
    <allow own="org.nddi.openflow_readonly" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Properties" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Introspectable" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.nddi.openflow_readonly" />
  </policy>

  <policy user="apache">
    <allow own="org.nddi.openflow_readonly" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Properties" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.freedesktop.DBus.Introspectable" />
    <allow send_destination="org.nddi.openflow_readonly"
           send_interface="org.nddi.openflow_readonly" />
  </policy>

  <!-- now we do the same for the fwctl dbus -->

  <policy user="root">
      <allow own="org.nddi.fwdctl" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.freedesktop.DBus.Properties" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.freedesktop.DBus.Introspectable" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.nddi.fwdctl" />
 </policy>

  <policy user="_oess">
        <allow own="org.nddi.fwdctl" />
        <allow send_destination="org.nddi.fwdctl"
               send_interface="org.freedesktop.DBus.Properties" />
        <allow send_destination="org.nddi.fwdctl"
               send_interface="org.freedesktop.DBus.Introspectable" />
        <allow send_destination="org.nddi.fwdctl"
               send_interface="org.nddi.fwdctl" />
  </policy>

  <policy user="apache">
      <allow own="org.nddi.fwdctl" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.freedesktop.DBus.Properties" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.freedesktop.DBus.Introspectable" />
      <allow send_destination="org.nddi.fwdctl"
             send_interface="org.nddi.fwdctl" />
 </policy>


</busconfig>

